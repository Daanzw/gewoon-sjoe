<!DOCTYPE html>
<html>
<head>
      <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>gewoon sjoe</title>
</head>
<body>
<!-- <canvas  id="myCanvas" width="1024" height="470"></canvas> -->
<script src="./bower_components/jquery/dist/jquery.min.js"></script>
<script src="./phaser.min.js"></script>
<script type="text/javascript">
   var game = new Phaser.Game(1024, 500, Phaser.AUTO, '', { preload: preload, create: create, update: update, checkPos: checkPos, collisionHandler : collisionHandler, });
    function preload () {

            game.load.image('bg', './assets/bg.jpg');
            game.load.image('sjoe', 'assets/sjoe.png'); 
            game.load.image('ground', 'assets/ground.png'); 
            game.load.image('penny', 'assets/penny.png'); 

        }

        var sjoe;
        var ground;
        var spaceKey;
        var penniesGroup;
        var text;
        var count;
        function create () {
            game.add.tileSprite(0, 0, 1024, 420, 'bg');
            game.physics.startSystem(Phaser.Physics.ARCADE);
            penniesGroup = game.add.physicsGroup();
            count = 0;
            for (var i = 0; i < 20; i++)
            {
                var pennies = penniesGroup.create(1024+Math.floor((Math.random() * 2000) + 1), Math.floor((Math.random() * 380) + 1), 'penny');
                pennies.body.velocity.x = -200;        
                pennies.scale.setTo(0.015,0.015);

            }
            sjoe = game.add.sprite(400, 200,'sjoe');
            sjoe.scale.setTo(0.25, 0.25);
            game.physics.arcade.enable(sjoe, Phaser.Physics.ARCADE);

            sjoe.body.velocity.y=2000;
            sjoe.body.collideWorldBounds = false;
            sjoe.body.bounce.set(0);
            sjoe.body.gravity.y=400;

            ground = this.game.add.tileSprite(0,420 , 1024, 80, 'ground');
            game.physics.arcade.enable(ground, Phaser.Physics.ARCADE);
            ground.autoScroll(-200, 0);
            ground.body.allowGravity = false;
            ground.body.immovable = true;

            this.spaceKey = game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
            game.input.keyboard.addKeyCapture(Phaser.Keyboard.SPACEBAR)
            game.input.mouse.capture = true;
            game.input.addPointer();
            text = game.add.text(0, 0, "Coins: 0", {
                font: "24px Arial",
                fill: "#fff",
            });

      
             
                    


        }
        function update () {
            game.physics.arcade.overlap(sjoe, penniesGroup, collisionHandler, null, this);
            game.physics.arcade.collide(sjoe,ground ); 
             if (this.spaceKey.isDown ||game.input.activePointer.leftButton.isDown || game.input.pointer1.isDown){
                sjoe.body.velocity.y = -250;
             }
               penniesGroup.forEach(checkPos, this);
        }      

        
        function checkPos(pennies) {
            if (pennies.x < -20)
            {
                pennies.x = 1024+Math.floor((Math.random() * 2000) + 1);
                pennies.y = Math.floor((Math.random() * 380) + 1)
            }

        }
        function collisionHandler(player , coin) {
            coin.x = 1024+Math.floor((Math.random() * 2000) + 1);
            coin.y = Math.floor((Math.random() * 380) + 1)
            count ++;

             text.setText("Coins: " + count );

        }

</script>



</body>
</html>